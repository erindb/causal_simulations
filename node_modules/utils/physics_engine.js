try {
	var p2 = require('./node_modules/p2/build/p2.js');
  var objects = {};
} catch(err) {
}

var convert_to_physics = function(w) {
  // do any conversions to create the bodies or whatever
  return w;
}

var convert_to_wppl = function(w) {
  // grab velocities and positions
  return w;
}

var setup_physics = function(w, result_index) {
  result_index = result_index || 0;

  // Init p2.js
  objects["world" + result_index] = new p2.World({
    gravity: [0, 0]
  });
  objects["world" + result_index].applyDamping = false;

  // Add a circle
  objects["ballAShape" + result_index] = new p2.Circle({width: 2, height: 1});
  objects["ballABody" + result_index] = new p2.Body({
    id: "A",
    mass: 1,
    position: [w.A.position*4-2, 0],
    velocity: [10*w.A.velocity, 0]
  });
  objects["ballABody" + result_index].addShape(objects["ballAShape" + result_index]);
  objects["world" + result_index].addBody(objects["ballABody" + result_index]);

  // Add a circle
  objects["ballBShape" + result_index] = new p2.Circle({width: 2, height: 1});
  objects["ballBBody" + result_index] = new p2.Body({
    id: "B",
    mass: 1,
    position: [w.B.position*4-2, 0],
    velocity: [10*w.B.velocity, 0]
  });
  objects["ballBBody" + result_index].addShape(objects["ballBShape" + result_index]);
  objects["world" + result_index].addBody(objects["ballBBody" + result_index]);

  // // Add a box
  // boxShape = new p2.Box({ width: 2, height: 1 });
  // boxBody = new p2.Body({
  //     mass:1,
  //     position:[0,2],
  //     angularVelocity:1
  // });
  // boxBody.addShape(boxShape);
  // world.addBody(boxBody);

  return objects["world" + result_index];
}

var run_physics_engine = function(w) {
	return w;
}

try{ 
	module.exports = {
		run_physics_engine: run_physics_engine,
    setup_physics: setup_physics
	}
} catch(err) {
}